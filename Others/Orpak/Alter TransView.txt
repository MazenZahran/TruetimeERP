ALTER VIEW [dbo].[TransView]
AS
SELECT T.id, T.timestamp, T.product_code AS StockID, T.sale AS DocAmount, T.ppv AS Price, T.quantity, T.proxy_id AS SentToJournal, F.code AS FleetCode, F.phone AS Mobile, F.zip AS SendMessage, T.shift_id, F.name AS FleetName, T.plate, 
                  T.product_name AS ItemName, CASE WHEN F.state = '' THEN 0 ELSE F.state END AS MonthlyVoucher, CASE WHEN F.city = '' THEN 0 ELSE F.city END AS SmsWithBalance
FROM     dbo.transactions AS T LEFT OUTER JOIN
                  dbo.fleets AS F ON T.fleet_id = F.id
WHERE  (T.type = 'CSTMR') AND (T.proxy_id = 0) AND (T.quantity <> 0) AND (T.sale <> 0)
GO